(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6150],{38352:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(94428).A)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]])},48517:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(94428).A)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},9294:(e,t,r)=>{"use strict";var a=r(73011).Buffer;let o=void 0!==a,n=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,s=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function l(e,t,r){null==r&&null!==t&&"object"==typeof t&&(r=t,t=void 0),o&&a.isBuffer(e)&&(e=e.toString()),e&&65279===e.charCodeAt(0)&&(e=e.slice(1));let l=JSON.parse(e,t);if(null===l||"object"!=typeof l)return l;let u=r&&r.protoAction||"error",c=r&&r.constructorAction||"error";if("ignore"===u&&"ignore"===c)return l;if("ignore"!==u&&"ignore"!==c){if(!1===n.test(e)&&!1===s.test(e))return l}else if("ignore"!==u&&"ignore"===c){if(!1===n.test(e))return l}else if(!1===s.test(e))return l;return i(l,{protoAction:u,constructorAction:c,safe:r&&r.safe})}function i(e,{protoAction:t="error",constructorAction:r="error",safe:a}={}){let o=[e];for(;o.length;){let e=o;for(let n of(o=[],e)){if("ignore"!==t&&Object.prototype.hasOwnProperty.call(n,"__proto__")){if(!0===a)return null;if("error"===t)throw SyntaxError("Object contains forbidden prototype property");delete n.__proto__}if("ignore"!==r&&Object.prototype.hasOwnProperty.call(n,"constructor")&&Object.prototype.hasOwnProperty.call(n.constructor,"prototype")){if(!0===a)return null;if("error"===r)throw SyntaxError("Object contains forbidden prototype property");delete n.constructor}for(let e in n){let t=n[e];t&&"object"==typeof t&&o.push(t)}}}return e}function u(e,t,r){let a=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return l(e,t,r)}finally{Error.stackTraceLimit=a}}e.exports=u,e.exports.default=u,e.exports.parse=u,e.exports.safeParse=function(e,t){let r=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return l(e,t,{safe:!0})}catch(e){return null}finally{Error.stackTraceLimit=r}},e.exports.scan=i},82346:e=>{e.exports=function(e,t){let r;if("function"!=typeof e)throw TypeError(`Expected the first argument to be a \`function\`, got \`${typeof e}\`.`);let a=0;return function(...o){clearTimeout(r);let n=Date.now(),s=t-(n-a);s<=0?(a=n,e.apply(this,o)):r=setTimeout(()=>{a=Date.now(),e.apply(this,o)},s)}}},40889:(e,t)=>{var r;!function(){"use strict";var a={}.hasOwnProperty;function o(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=n(e,function(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return o.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)a.call(e,r)&&e[r]&&(t=n(t,r));return t}(r)))}return e}function n(e,t){return t?e?e+" "+t:e+t:e}e.exports?(o.default=o,e.exports=o):void 0!==(r=(function(){return o}).apply(t,[]))&&(e.exports=r)}()},41823:(e,t,r)=>{"use strict";let a;r.d(t,{Y_:()=>e2});var o,n,s,l,i=r(79790),u="vercel.ai.error",c=Symbol.for(u),p=class e extends Error{constructor({name:e,message:t,cause:r}){super(t),this[o]=!0,this.name=e,this.cause=r}static isInstance(t){return e.hasMarker(t,u)}static hasMarker(e,t){let r=Symbol.for(t);return null!=e&&"object"==typeof e&&r in e&&"boolean"==typeof e[r]&&!0===e[r]}};o=c;var d=p;function f(e){return null==e?"unknown error":"string"==typeof e?e:e instanceof Error?e.message:JSON.stringify(e)}Symbol.for("vercel.ai.error.AI_APICallError"),Symbol.for("vercel.ai.error.AI_EmptyResponseBodyError");var g="AI_InvalidArgumentError",h=`vercel.ai.error.${g}`,y=Symbol.for(h),m=class extends d{constructor({message:e,cause:t,argument:r}){super({name:g,message:e,cause:t}),this[n]=!0,this.argument=r}static isInstance(e){return d.hasMarker(e,h)}};n=y,Symbol.for("vercel.ai.error.AI_InvalidPromptError"),Symbol.for("vercel.ai.error.AI_InvalidResponseDataError");var _="AI_JSONParseError",E=`vercel.ai.error.${_}`,I=Symbol.for(E),v=class extends d{constructor({text:e,cause:t}){super({name:_,message:`JSON parsing failed: Text: ${e}.
Error message: ${f(t)}`,cause:t}),this[s]=!0,this.text=e}static isInstance(e){return d.hasMarker(e,E)}};s=I,Symbol.for("vercel.ai.error.AI_LoadAPIKeyError"),Symbol.for("vercel.ai.error.AI_LoadSettingError"),Symbol.for("vercel.ai.error.AI_NoContentGeneratedError"),Symbol.for("vercel.ai.error.AI_NoSuchModelError"),Symbol.for("vercel.ai.error.AI_TooManyEmbeddingValuesForCallError");var b="AI_TypeValidationError",w=`vercel.ai.error.${b}`,T=Symbol.for(w),A=class e extends d{constructor({value:e,cause:t}){super({name:b,message:`Type validation failed: Value: ${JSON.stringify(e)}.
Error message: ${f(t)}`,cause:t}),this[l]=!0,this.value=e}static isInstance(e){return d.hasMarker(e,w)}static wrap({value:t,cause:r}){return e.isInstance(r)&&r.value===t?r:new e({value:t,cause:r})}};function S(e){return null===e||"string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(S):"object"==typeof e&&Object.entries(e).every(([e,t])=>"string"==typeof e&&S(t)))}l=T,Symbol.for("vercel.ai.error.AI_UnsupportedFunctionalityError");let k=(e,t=21)=>(r=t)=>{let a="",o=0|r;for(;o--;)a+=e[Math.random()*e.length|0];return a};var R=r(9294);r(5183);var C=(({prefix:e,size:t=16,alphabet:r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:a="-"}={})=>{let o=k(r,t);if(null==e)return o;if(r.includes(a))throw new m({argument:"separator",message:`The separator "${a}" must not be part of the alphabet "${r}".`});return t=>`${e}${a}${o(t)}`})(),N=Symbol.for("vercel.ai.validator");function x({text:e,schema:t}){try{let r=R.parse(e);if(null==t)return{success:!0,value:r,rawValue:r};let a=function({value:e,schema:t}){let r="object"==typeof t&&null!==t&&N in t&&!0===t[N]&&"validate"in t?t:{[N]:!0,validate:e=>{let r=t.safeParse(e);return r.success?{success:!0,value:r.data}:{success:!1,error:r.error}}};try{if(null==r.validate)return{success:!0,value:e};let t=r.validate(e);if(t.success)return t;return{success:!1,error:A.wrap({value:e,cause:t.error})}}catch(t){return{success:!1,error:A.wrap({value:e,cause:t})}}}({value:r,schema:t});return a.success?{...a,rawValue:r}:a}catch(t){return{success:!1,error:v.isInstance(t)?t:new v({text:e,cause:t})}}}var{btoa:O,atob:D}=globalThis;Symbol("Let zodToJsonSchema decide on which parser to use");let L=(e,t)=>{let r=0;for(;r<e.length&&r<t.length&&e[r]===t[r];r++);return[(e.length-r).toString(),...t.slice(r)].join("/")};var F={code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},j={code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},M={code:"4",name:"assistant_message",parse:e=>{if(null==e||"object"!=typeof e||!("id"in e)||!("role"in e)||!("content"in e)||"string"!=typeof e.id||"string"!=typeof e.role||"assistant"!==e.role||!Array.isArray(e.content)||!e.content.every(e=>null!=e&&"object"==typeof e&&"type"in e&&"text"===e.type&&"text"in e&&null!=e.text&&"object"==typeof e.text&&"value"in e.text&&"string"==typeof e.text.value))throw Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},P={code:"5",name:"assistant_control_data",parse:e=>{if(null==e||"object"!=typeof e||!("threadId"in e)||!("messageId"in e)||"string"!=typeof e.threadId||"string"!=typeof e.messageId)throw Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},V={code:"6",name:"data_message",parse:e=>{if(null==e||"object"!=typeof e||!("role"in e)||!("data"in e)||"string"!=typeof e.role||"data"!==e.role)throw Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},B=[F,j,M,P,V];F.code,j.code,M.code,P.code,V.code,F.name,F.code,j.name,j.code,M.name,M.code,P.name,P.code,V.name,V.code,B.map(e=>e.code);var J=[{code:"0",name:"text",parse:e=>{if("string"!=typeof e)throw Error('"text" parts expect a string value.');return{type:"text",value:e}}},{code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw Error('"data" parts expect an array value.');return{type:"data",value:e}}},{code:"3",name:"error",parse:e=>{if("string"!=typeof e)throw Error('"error" parts expect a string value.');return{type:"error",value:e}}},{code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},{code:"9",name:"tool_call",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName||!("args"in e)||"object"!=typeof e.args)throw Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},{code:"a",name:"tool_result",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("result"in e))throw Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},{code:"b",name:"tool_call_streaming_start",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("toolName"in e)||"string"!=typeof e.toolName)throw Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},{code:"c",name:"tool_call_delta",parse:e=>{if(null==e||"object"!=typeof e||!("toolCallId"in e)||"string"!=typeof e.toolCallId||!("argsTextDelta"in e)||"string"!=typeof e.argsTextDelta)throw Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},{code:"d",name:"finish_message",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_message" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},{code:"e",name:"finish_step",parse:e=>{if(null==e||"object"!=typeof e||!("finishReason"in e)||"string"!=typeof e.finishReason)throw Error('"finish_step" parts expect an object with a "finishReason" property.');let t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&null!=e.usage&&"object"==typeof e.usage&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:"number"==typeof e.usage.promptTokens?e.usage.promptTokens:Number.NaN,completionTokens:"number"==typeof e.usage.completionTokens?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&"boolean"==typeof e.isContinued&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},{code:"f",name:"start_step",parse:e=>{if(null==e||"object"!=typeof e||!("messageId"in e)||"string"!=typeof e.messageId)throw Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},{code:"g",name:"reasoning",parse:e=>{if("string"!=typeof e)throw Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},{code:"h",name:"source",parse:e=>{if(null==e||"object"!=typeof e)throw Error('"source" parts expect a Source object.');return{type:"source",value:e}}}],U=Object.fromEntries(J.map(e=>[e.code,e]));Object.fromEntries(J.map(e=>[e.name,e.code]));var Y=J.map(e=>e.code),$=e=>{let t=e.indexOf(":");if(-1===t)throw Error("Failed to parse stream string. No separator found.");let r=e.slice(0,t);if(!Y.includes(r))throw Error(`Failed to parse stream string. Invalid code ${r}.`);let a=JSON.parse(e.slice(t+1));return U[r].parse(a)};async function W({stream:e,onTextPart:t,onReasoningPart:r,onSourcePart:a,onDataPart:o,onErrorPart:n,onToolCallStreamingStartPart:s,onToolCallDeltaPart:l,onToolCallPart:i,onToolResultPart:u,onMessageAnnotationsPart:c,onFinishMessagePart:p,onFinishStepPart:d,onStartStepPart:f}){let g=e.getReader(),h=new TextDecoder,y=[],m=0;for(;;){let{value:e}=await g.read();if(e&&(y.push(e),m+=e.length,10!==e[e.length-1]))continue;if(0===y.length)break;let _=function(e,t){let r=new Uint8Array(t),a=0;for(let t of e)r.set(t,a),a+=t.length;return e.length=0,r}(y,m);for(let{type:e,value:g}of(m=0,h.decode(_,{stream:!0}).split("\n").filter(e=>""!==e).map($)))switch(e){case"text":await (null==t?void 0:t(g));break;case"reasoning":await (null==r?void 0:r(g));break;case"source":await (null==a?void 0:a(g));break;case"data":await (null==o?void 0:o(g));break;case"error":await (null==n?void 0:n(g));break;case"message_annotations":await (null==c?void 0:c(g));break;case"tool_call_streaming_start":await (null==s?void 0:s(g));break;case"tool_call_delta":await (null==l?void 0:l(g));break;case"tool_call":await (null==i?void 0:i(g));break;case"tool_result":await (null==u?void 0:u(g));break;case"finish_message":await (null==p?void 0:p(g));break;case"finish_step":await (null==d?void 0:d(g));break;case"start_step":await (null==f?void 0:f(g));break;default:throw Error(`Unknown stream part type: ${e}`)}}}async function K({stream:e,update:t,onToolCall:r,onFinish:a,generateId:o=C,getCurrentDate:n=()=>new Date,lastMessage:s}){var l,i;let u,c;let p=(null==s?void 0:s.role)==="assistant",d=p?1+(null!=(i=null==(l=s.toolInvocations)?void 0:l.reduce((e,t)=>{var r;return Math.max(e,null!=(r=t.step)?r:0)},0))?i:0):0,f=p?structuredClone(s):{id:o(),createdAt:n(),role:"assistant",content:"",parts:[]};function g(e,t){let r=f.parts.find(t=>"tool-invocation"===t.type&&t.toolInvocation.toolCallId===e);null!=r?r.toolInvocation=t:f.parts.push({type:"tool-invocation",toolInvocation:t})}let h=[],y=p?null==s?void 0:s.annotations:void 0,m={},_={completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},E="unknown";function I(){let e=[...h];(null==y?void 0:y.length)&&(f.annotations=y),t({message:{...structuredClone(f),revisionId:o()},data:e,replaceLastMessage:p})}await W({stream:e,onTextPart(e){null==u?(u={type:"text",text:e},f.parts.push(u)):u.text+=e,f.content+=e,I()},onReasoningPart(e){var t;null==c?(c={type:"reasoning",reasoning:e},f.parts.push(c)):c.reasoning+=e,f.reasoning=(null!=(t=f.reasoning)?t:"")+e,I()},onSourcePart(e){f.parts.push({type:"source",source:e}),I()},onToolCallStreamingStartPart(e){null==f.toolInvocations&&(f.toolInvocations=[]),m[e.toolCallId]={text:"",step:d,toolName:e.toolName,index:f.toolInvocations.length};let t={state:"partial-call",step:d,toolCallId:e.toolCallId,toolName:e.toolName,args:void 0};f.toolInvocations.push(t),g(e.toolCallId,t),I()},onToolCallDeltaPart(e){let t=m[e.toolCallId];t.text+=e.argsTextDelta;let{value:r}=function(e){if(void 0===e)return{value:void 0,state:"undefined-input"};let t=x({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=x({text:function(e){let t=["ROOT"],r=-1,a=null;function o(e,o,n){switch(e){case'"':r=o,t.pop(),t.push(n),t.push("INSIDE_STRING");break;case"f":case"t":case"n":r=o,a=o,t.pop(),t.push(n),t.push("INSIDE_LITERAL");break;case"-":t.pop(),t.push(n),t.push("INSIDE_NUMBER");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=o,t.pop(),t.push(n),t.push("INSIDE_NUMBER");break;case"{":r=o,t.pop(),t.push(n),t.push("INSIDE_OBJECT_START");break;case"[":r=o,t.pop(),t.push(n),t.push("INSIDE_ARRAY_START")}}function n(e,a){switch(e){case",":t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break;case"}":r=a,t.pop()}}function s(e,a){switch(e){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=a,t.pop()}}for(let l=0;l<e.length;l++){let i=e[l];switch(t[t.length-1]){case"ROOT":o(i,l,"FINISH");break;case"INSIDE_OBJECT_START":switch(i){case'"':t.pop(),t.push("INSIDE_OBJECT_KEY");break;case"}":r=l,t.pop()}break;case"INSIDE_OBJECT_AFTER_COMMA":'"'===i&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break;case"INSIDE_OBJECT_KEY":'"'===i&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break;case"INSIDE_OBJECT_AFTER_KEY":":"===i&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break;case"INSIDE_OBJECT_BEFORE_VALUE":o(i,l,"INSIDE_OBJECT_AFTER_VALUE");break;case"INSIDE_OBJECT_AFTER_VALUE":n(i,l);break;case"INSIDE_STRING":switch(i){case'"':t.pop(),r=l;break;case"\\":t.push("INSIDE_STRING_ESCAPE");break;default:r=l}break;case"INSIDE_ARRAY_START":"]"===i?(r=l,t.pop()):(r=l,o(i,l,"INSIDE_ARRAY_AFTER_VALUE"));break;case"INSIDE_ARRAY_AFTER_VALUE":switch(i){case",":t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break;case"]":r=l,t.pop();break;default:r=l}break;case"INSIDE_ARRAY_AFTER_COMMA":o(i,l,"INSIDE_ARRAY_AFTER_VALUE");break;case"INSIDE_STRING_ESCAPE":t.pop(),r=l;break;case"INSIDE_NUMBER":switch(i){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":r=l;break;case"e":case"E":case"-":case".":break;case",":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(i,l),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&n(i,l);break;case"}":t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]&&n(i,l);break;case"]":t.pop(),"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(i,l);break;default:t.pop()}break;case"INSIDE_LITERAL":{let o=e.substring(a,l+1);"false".startsWith(o)||"true".startsWith(o)||"null".startsWith(o)?r=l:(t.pop(),"INSIDE_OBJECT_AFTER_VALUE"===t[t.length-1]?n(i,l):"INSIDE_ARRAY_AFTER_VALUE"===t[t.length-1]&&s(i,l))}}}let l=e.slice(0,r+1);for(let r=t.length-1;r>=0;r--)switch(t[r]){case"INSIDE_STRING":l+='"';break;case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":l+="}";break;case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":l+="]";break;case"INSIDE_LITERAL":{let t=e.substring(a,e.length);"true".startsWith(t)?l+="true".slice(t.length):"false".startsWith(t)?l+="false".slice(t.length):"null".startsWith(t)&&(l+="null".slice(t.length))}}return l}(e)})).success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"}}(t.text),a={state:"partial-call",step:t.step,toolCallId:e.toolCallId,toolName:t.toolName,args:r};f.toolInvocations[t.index]=a,g(e.toolCallId,a),I()},async onToolCallPart(e){let t={state:"call",step:d,...e};if(null!=m[e.toolCallId]?f.toolInvocations[m[e.toolCallId].index]=t:(null==f.toolInvocations&&(f.toolInvocations=[]),f.toolInvocations.push(t)),g(e.toolCallId,t),I(),r){let t=await r({toolCall:e});if(null!=t){let r={state:"result",step:d,...e,result:t};f.toolInvocations[f.toolInvocations.length-1]=r,g(e.toolCallId,r),I()}}},onToolResultPart(e){let t=f.toolInvocations;if(null==t)throw Error("tool_result must be preceded by a tool_call");let r=t.findIndex(t=>t.toolCallId===e.toolCallId);if(-1===r)throw Error("tool_result must be preceded by a tool_call with the same toolCallId");let a={...t[r],state:"result",...e};t[r]=a,g(e.toolCallId,a),I()},onDataPart(e){h.push(...e),I()},onMessageAnnotationsPart(e){null==y?y=[...e]:y.push(...e),I()},onFinishStepPart(e){d+=1,u=e.isContinued?u:void 0,c=void 0},onStartStepPart(e){p||(f.id=e.messageId)},onFinishMessagePart(e){E=e.finishReason,null!=e.usage&&(_=function({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}(e.usage))},onErrorPart(e){throw Error(e)}}),null==a||a({message:f,finishReason:E,usage:_})}async function G({stream:e,onTextPart:t}){let r=e.pipeThrough(new TextDecoderStream).getReader();for(;;){let{done:e,value:a}=await r.read();if(e)break;await t(a)}}async function q({stream:e,update:t,onFinish:r,getCurrentDate:a=()=>new Date,generateId:o=C}){let n={type:"text",text:""},s={id:o(),createdAt:a(),role:"assistant",content:"",parts:[n]};await G({stream:e,onTextPart:e=>{s.content+=e,n.text+=e,t({message:{...s},data:[],replaceLastMessage:!1})}}),null==r||r(s,{usage:{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN},finishReason:"unknown"})}var z=()=>fetch;async function H({api:e,body:t,streamProtocol:r="data",credentials:a,headers:o,abortController:n,restoreMessagesOnFailure:s,onResponse:l,onUpdate:i,onFinish:u,onToolCall:c,generateId:p,fetch:d=z(),lastMessage:f}){var g,h;let y=await d(e,{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",...o},signal:null==(g=null==n?void 0:n())?void 0:g.signal,credentials:a}).catch(e=>{throw s(),e});if(l)try{await l(y)}catch(e){throw e}if(!y.ok)throw s(),Error(null!=(h=await y.text())?h:"Failed to fetch the chat response.");if(!y.body)throw Error("The response body is empty.");switch(r){case"text":await q({stream:y.body,update:i,onFinish:u,generateId:p});return;case"data":await K({stream:y.body,update:i,lastMessage:f,onToolCall:c,onFinish({message:e,finishReason:t,usage:r}){u&&null!=e&&u(e,{usage:r,finishReason:t})},generateId:p});return;default:throw Error(`Unknown stream protocol: ${r}`)}}function Z(e){return null==e?void 0:e.reduce((e,t)=>{var r;return Math.max(e,null!=(r=t.step)?r:0)},0)}function Q(e){var t;return null!=(t=e.parts)?t:[...e.toolInvocations?e.toolInvocations.map(e=>({type:"tool-invocation",toolInvocation:e})):[],...e.reasoning?[{type:"reasoning",reasoning:e.reasoning}]:[],...e.content?[{type:"text",text:e.content}]:[]]}function X(e){return e.map(e=>({...e,parts:Q(e)}))}async function ee(e){if(!e)return[];if(e instanceof FileList)return Promise.all(Array.from(e).map(async e=>{let{name:t,type:r}=e;return{name:t,contentType:r,url:await new Promise((t,r)=>{let a=new FileReader;a.onload=e=>{var r;t(null==(r=e.target)?void 0:r.result)},a.onerror=e=>r(e),a.readAsDataURL(e)})}}));if(Array.isArray(e))return e;throw Error("Invalid attachments type")}function et(e){return"assistant"===e.role&&e.parts.filter(e=>"tool-invocation"===e.type).every(e=>"result"in e.toolInvocation)}Symbol.for("vercel.ai.schema");var er=r(28340),ea=Object.prototype.hasOwnProperty;let eo=new WeakMap,en=()=>{},es=en(),el=Object,ei=e=>e===es,eu=e=>"function"==typeof e,ec=(e,t)=>({...e,...t}),ep=e=>eu(e.then),ed={},ef={},eg="undefined",eh=typeof window!=eg,ey=typeof document!=eg,em=eh&&"Deno"in window,e_=()=>eh&&typeof window.requestAnimationFrame!=eg,eE=(e,t)=>{let r=eo.get(e);return[()=>!ei(t)&&e.get(t)||ed,a=>{if(!ei(t)){let o=e.get(t);t in ef||(ef[t]=o),r[5](t,ec(o,a),o||ed)}},r[6],()=>!ei(t)&&t in ef?ef[t]:!ei(t)&&e.get(t)||ed]},eI=!0,[ev,eb]=eh&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[en,en],ew={initFocus:e=>(ey&&document.addEventListener("visibilitychange",e),ev("focus",e),()=>{ey&&document.removeEventListener("visibilitychange",e),eb("focus",e)}),initReconnect:e=>{let t=()=>{eI=!0,e()},r=()=>{eI=!1};return ev("online",t),ev("offline",r),()=>{eb("online",t),eb("offline",r)}}},eT=!i.useId,eA=!eh||em,eS=e=>e_()?window.requestAnimationFrame(e):setTimeout(e,1),ek=eA?i.useEffect:i.useLayoutEffect,eR="undefined"!=typeof navigator&&navigator.connection,eC=!eA&&eR&&(["slow-2g","2g"].includes(eR.effectiveType)||eR.saveData),eN=new WeakMap,ex=(e,t)=>el.prototype.toString.call(e)==="[object ".concat(t,"]"),eO=0,eD=e=>{let t,r;let a=typeof e,o=ex(e,"Date"),n=ex(e,"RegExp"),s=ex(e,"Object");if(el(e)!==e||o||n)t=o?e.toJSON():"symbol"==a?e.toString():"string"==a?JSON.stringify(e):""+e;else{if(t=eN.get(e))return t;if(t=++eO+"~",eN.set(e,t),Array.isArray(e)){for(r=0,t="@";r<e.length;r++)t+=eD(e[r])+",";eN.set(e,t)}if(s){t="#";let a=el.keys(e).sort();for(;!ei(r=a.pop());)ei(e[r])||(t+=r+":"+eD(e[r])+",");eN.set(e,t)}}return t},eL=e=>{if(eu(e))try{e=e()}catch(t){e=""}let t=e;return[e="string"==typeof e?e:(Array.isArray(e)?e.length:e)?eD(e):"",t]},eF=0,ej=()=>++eF;async function eM(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let[a,o,n,s]=t,l=ec({populateCache:!0,throwOnError:!0},"boolean"==typeof s?{revalidate:s}:s||{}),i=l.populateCache,u=l.rollbackOnError,c=l.optimisticData,p=e=>"function"==typeof u?u(e):!1!==u,d=l.throwOnError;if(eu(o)){let e=[];for(let t of a.keys())!/^\$(inf|sub)\$/.test(t)&&o(a.get(t)._k)&&e.push(t);return Promise.all(e.map(f))}return f(o);async function f(e){let r;let[o]=eL(e);if(!o)return;let[s,u]=eE(a,o),[f,g,h,y]=eo.get(a),m=()=>{let t=f[o];return(eu(l.revalidate)?l.revalidate(s().data,e):!1!==l.revalidate)&&(delete h[o],delete y[o],t&&t[0])?t[0](2).then(()=>s().data):s().data};if(t.length<3)return m();let _=n,E=ej();g[o]=[E,0];let I=!ei(c),v=s(),b=v.data,w=v._c,T=ei(w)?b:w;if(I&&u({data:c=eu(c)?c(T,b):c,_c:T}),eu(_))try{_=_(T)}catch(e){r=e}if(_&&ep(_)){if(_=await _.catch(e=>{r=e}),E!==g[o][0]){if(r)throw r;return _}r&&I&&p(r)&&(i=!0,u({data:T,_c:es}))}if(i&&!r&&(eu(i)?u({data:i(_,T),error:es,_c:es}):u({data:_,error:es,_c:es})),g[o][1]=ej(),Promise.resolve(m()).then(()=>{u({_c:es})}),r){if(d)throw r;return}return _}}let eP=(e,t)=>{for(let r in e)e[r][0]&&e[r][0](t)},eV=(e,t)=>{if(!eo.has(e)){let r=ec(ew,t),a={},o=eM.bind(es,e),n=en,s={},l=(e,t)=>{let r=s[e]||[];return s[e]=r,r.push(t),()=>r.splice(r.indexOf(t),1)},i=(t,r,a)=>{e.set(t,r);let o=s[t];if(o)for(let e of o)e(r,a)},u=()=>{if(!eo.has(e)&&(eo.set(e,[a,{},{},{},o,i,l]),!eA)){let t=r.initFocus(setTimeout.bind(es,eP.bind(es,a,0))),o=r.initReconnect(setTimeout.bind(es,eP.bind(es,a,1)));n=()=>{t&&t(),o&&o(),eo.delete(e)}}};return u(),[e,o,u,n]}return[e,eo.get(e)[4]]},[eB,eJ]=eV(new Map),eU=ec({onLoadingSlow:en,onSuccess:en,onError:en,onErrorRetry:(e,t,r,a,o)=>{let n=r.errorRetryCount,s=o.retryCount,l=~~((Math.random()+.5)*(1<<(s<8?s:8)))*r.errorRetryInterval;(ei(n)||!(s>n))&&setTimeout(a,l,o)},onDiscarded:en,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:eC?1e4:5e3,focusThrottleInterval:5e3,dedupingInterval:2e3,loadingTimeout:eC?5e3:3e3,compare:function e(t,r){var a,o;if(t===r)return!0;if(t&&r&&(a=t.constructor)===r.constructor){if(a===Date)return t.getTime()===r.getTime();if(a===RegExp)return t.toString()===r.toString();if(a===Array){if((o=t.length)===r.length)for(;o--&&e(t[o],r[o]););return -1===o}if(!a||"object"==typeof t){for(a in o=0,t)if(ea.call(t,a)&&++o&&!ea.call(r,a)||!(a in r)||!e(t[a],r[a]))return!1;return Object.keys(r).length===o}}return t!=t&&r!=r},isPaused:()=>!1,cache:eB,mutate:eJ,fallback:{}},{isOnline:()=>eI,isVisible:()=>{let e=ey&&document.visibilityState;return ei(e)||"hidden"!==e}}),eY=(e,t)=>{let r=ec(e,t);if(t){let{use:a,fallback:o}=e,{use:n,fallback:s}=t;a&&n&&(r.use=a.concat(n)),o&&s&&(r.fallback=ec(o,s))}return r},e$=(0,i.createContext)({}),eW=eh&&window.__SWR_DEVTOOLS_USE__,eK=eW?window.__SWR_DEVTOOLS_USE__:[],eG=e=>eu(e[1])?[e[0],e[1],e[2]||{}]:[e[0],null,(null===e[1]?e[2]:e[1])||{}],eq=()=>ec(eU,(0,i.useContext)(e$)),ez=eK.concat(e=>(t,r,a)=>{let o=r&&((...e)=>{let[a]=eL(t),[,,,o]=eo.get(eB);if(a.startsWith("$inf$"))return r(...e);let n=o[a];return ei(n)?r(...e):(delete o[a],n)});return e(t,o,a)}),eH=(e,t,r)=>{let a=t[e]||(t[e]=[]);return a.push(r),()=>{let e=a.indexOf(r);e>=0&&(a[e]=a[a.length-1],a.pop())}};eW&&(window.__SWR_DEVTOOLS_REACT__=i);let eZ=()=>{};eZ(),new WeakMap;let eQ=i.use||(e=>{switch(e.status){case"pending":throw e;case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e}}),eX={dedupe:!0};el.defineProperty(e=>{let{value:t}=e,r=(0,i.useContext)(e$),a=eu(t),o=(0,i.useMemo)(()=>a?t(r):t,[a,r,t]),n=(0,i.useMemo)(()=>a?o:eY(r,o),[a,r,o]),s=o&&o.provider,l=(0,i.useRef)(es);s&&!l.current&&(l.current=eV(s(n.cache||eB),o));let u=l.current;return u&&(n.cache=u[0],n.mutate=u[1]),ek(()=>{if(u)return u[2]&&u[2](),u[3]},[]),(0,i.createElement)(e$.Provider,ec(e,{value:n}))},"defaultValue",{value:eU});let e0=(a=(e,t,r)=>{let{cache:a,compare:o,suspense:n,fallbackData:s,revalidateOnMount:l,revalidateIfStale:u,refreshInterval:c,refreshWhenHidden:p,refreshWhenOffline:d,keepPreviousData:f}=r,[g,h,y,m]=eo.get(a),[_,E]=eL(e),I=(0,i.useRef)(!1),v=(0,i.useRef)(!1),b=(0,i.useRef)(_),w=(0,i.useRef)(t),T=(0,i.useRef)(r),A=()=>T.current,S=()=>A().isVisible()&&A().isOnline(),[k,R,C,N]=eE(a,_),x=(0,i.useRef)({}).current,O=ei(s)?ei(r.fallback)?es:r.fallback[_]:s,D=(e,t)=>{for(let r in x)if("data"===r){if(!o(e[r],t[r])&&(!ei(e[r])||!o(U,t[r])))return!1}else if(t[r]!==e[r])return!1;return!0},L=(0,i.useMemo)(()=>{let e=!!_&&!!t&&(ei(l)?!A().isPaused()&&!n&&!1!==u:l),r=t=>{let r=ec(t);return(delete r._k,e)?{isValidating:!0,isLoading:!0,...r}:r},a=k(),o=N(),s=r(a),i=a===o?s:r(o),c=s;return[()=>{let e=r(k());return D(e,c)?(c.data=e.data,c.isLoading=e.isLoading,c.isValidating=e.isValidating,c.error=e.error,c):(c=e,e)},()=>i]},[a,_]),F=(0,er.useSyncExternalStore)((0,i.useCallback)(e=>C(_,(t,r)=>{D(r,t)||e()}),[a,_]),L[0],L[1]),j=!I.current,M=g[_]&&g[_].length>0,P=F.data,V=ei(P)?O&&ep(O)?eQ(O):O:P,B=F.error,J=(0,i.useRef)(V),U=f?ei(P)?ei(J.current)?V:J.current:P:V,Y=(!M||!!ei(B))&&(j&&!ei(l)?l:!A().isPaused()&&(n?!ei(V)&&u:ei(V)||u)),$=!!(_&&t&&j&&Y),W=ei(F.isValidating)?$:F.isValidating,K=ei(F.isLoading)?$:F.isLoading,G=(0,i.useCallback)(async e=>{let t,a;let n=w.current;if(!_||!n||v.current||A().isPaused())return!1;let s=!0,l=e||{},i=!y[_]||!l.dedupe,u=()=>eT?!v.current&&_===b.current&&I.current:_===b.current,c={isValidating:!1,isLoading:!1},p=()=>{R(c)},d=()=>{let e=y[_];e&&e[1]===a&&delete y[_]},f={isValidating:!0};ei(k().data)&&(f.isLoading=!0);try{if(i&&(R(f),r.loadingTimeout&&ei(k().data)&&setTimeout(()=>{s&&u()&&A().onLoadingSlow(_,r)},r.loadingTimeout),y[_]=[n(E),ej()]),[t,a]=y[_],t=await t,i&&setTimeout(d,r.dedupingInterval),!y[_]||y[_][1]!==a)return i&&u()&&A().onDiscarded(_),!1;c.error=es;let e=h[_];if(!ei(e)&&(a<=e[0]||a<=e[1]||0===e[1]))return p(),i&&u()&&A().onDiscarded(_),!1;let l=k().data;c.data=o(l,t)?l:t,i&&u()&&A().onSuccess(t,_,r)}catch(r){d();let e=A(),{shouldRetryOnError:t}=e;!e.isPaused()&&(c.error=r,i&&u()&&(e.onError(r,_,e),(!0===t||eu(t)&&t(r))&&(!A().revalidateOnFocus||!A().revalidateOnReconnect||S())&&e.onErrorRetry(r,_,e,e=>{let t=g[_];t&&t[0]&&t[0](3,e)},{retryCount:(l.retryCount||0)+1,dedupe:!0})))}return s=!1,p(),!0},[_,a]),q=(0,i.useCallback)((...e)=>eM(a,b.current,...e),[]);if(ek(()=>{w.current=t,T.current=r,ei(P)||(J.current=P)}),ek(()=>{if(!_)return;let e=G.bind(es,eX),t=0,r=eH(_,g,(r,a={})=>{if(0==r){let r=Date.now();A().revalidateOnFocus&&r>t&&S()&&(t=r+A().focusThrottleInterval,e())}else if(1==r)A().revalidateOnReconnect&&S()&&e();else if(2==r)return G();else if(3==r)return G(a)});return v.current=!1,b.current=_,I.current=!0,R({_k:E}),Y&&(ei(V)||eA?e():eS(e)),()=>{v.current=!0,r()}},[_]),ek(()=>{let e;function t(){let t=eu(c)?c(k().data):c;t&&-1!==e&&(e=setTimeout(r,t))}function r(){!k().error&&(p||A().isVisible())&&(d||A().isOnline())?G(eX).then(t):t()}return t(),()=>{e&&(clearTimeout(e),e=-1)}},[c,p,d,_]),(0,i.useDebugValue)(U),n&&ei(V)&&_){if(!eT&&eA)throw Error("Fallback data is required when using Suspense in SSR.");w.current=t,T.current=r,v.current=!1;let e=m[_];if(ei(e)||eQ(q(e)),ei(B)){let e=G(eX);ei(U)||(e.status="fulfilled",e.value=!0),eQ(e)}else throw B}return{mutate:q,get data(){return x.data=!0,U},get error(){return x.error=!0,B},get isValidating(){return x.isValidating=!0,W},get isLoading(){return x.isLoading=!0,K}}},function(...e){let t=eq(),[r,o,n]=eG(e),s=eY(t,n),l=a,{use:i}=s,u=(i||[]).concat(ez);for(let e=u.length;e--;)l=u[e](l);return l(r,o||s.fetcher||null,s)});var e1=r(82346);function e5(e,t){return null!=t?e1(e,t):e}function e2({api:e="/api/chat",id:t,initialMessages:r,initialInput:a="",sendExtraMessageFields:o,onToolCall:n,experimental_prepareRequestBody:s,maxSteps:l=1,streamProtocol:u="data",onResponse:c,onFinish:p,onError:d,credentials:f,headers:g,body:h,generateId:y=C,fetch:m,keepLastMessageOnError:_=!0,experimental_throttle:E}={}){let[I]=(0,i.useState)(y),v=null!=t?t:I,b="string"==typeof e?[e,v]:v,[w]=(0,i.useState)([]),{data:T,mutate:A}=e0([b,"messages"],null,{fallbackData:null!=r?X(r):w}),S=(0,i.useRef)(T||[]);(0,i.useEffect)(()=>{S.current=T||[]},[T]);let{data:k,mutate:R}=e0([b,"streamData"],null),N=(0,i.useRef)(k);(0,i.useEffect)(()=>{N.current=k},[k]);let{data:x="ready",mutate:O}=e0([b,"status"],null),{data:D,mutate:L}=e0([b,"error"],null),F=(0,i.useRef)(null),j=(0,i.useRef)({credentials:f,headers:g,body:h});(0,i.useEffect)(()=>{j.current={credentials:f,headers:g,body:h}},[f,g,h]);let M=(0,i.useCallback)(async t=>{var r,a;O("submitted"),L(void 0);let i=X(t.messages),f=i.length,g=Z(null==(r=i[i.length-1])?void 0:r.toolInvocations);try{let r=new AbortController;F.current=r;let l=e5(A,E),d=e5(R,E),f=S.current;l(i,!1);let g=o?i:i.map(({role:e,content:t,experimental_attachments:r,data:a,annotations:o,toolInvocations:n,parts:s})=>({role:e,content:t,...void 0!==r&&{experimental_attachments:r},...void 0!==a&&{data:a},...void 0!==o&&{annotations:o},...void 0!==n&&{toolInvocations:n},...void 0!==s&&{parts:s}})),h=N.current;await H({api:e,body:null!=(a=null==s?void 0:s({id:v,messages:i,requestData:t.data,requestBody:t.body}))?a:{id:v,messages:g,data:t.data,...j.current.body,...t.body},streamProtocol:u,credentials:j.current.credentials,headers:{...j.current.headers,...t.headers},abortController:()=>F.current,restoreMessagesOnFailure(){_||l(f,!1)},onResponse:c,onUpdate({message:e,data:t,replaceLastMessage:r}){O("streaming"),l([...r?i.slice(0,i.length-1):i,e],!1),(null==t?void 0:t.length)&&d([...null!=h?h:[],...t],!1)},onToolCall:n,onFinish:p,generateId:y,fetch:m,lastMessage:i[i.length-1]}),F.current=null,O("ready")}catch(e){if("AbortError"===e.name)return F.current=null,O("ready"),null;d&&e instanceof Error&&d(e),L(e),O("error")}let h=S.current;(function({originalMaxToolInvocationStep:e,originalMessageCount:t,maxSteps:r,messages:a}){var o;let n;let s=a[a.length-1];return r>1&&null!=s&&(a.length>t||Z(s.toolInvocations)!==e)&&et(s)&&(n=!1,s.parts.forEach(e=>{"text"===e.type&&(n=!0),"tool-invocation"===e.type&&(n=!1)}),!n)&&(null!=(o=Z(s.toolInvocations))?o:0)<r})({originalMaxToolInvocationStep:g,originalMessageCount:f,maxSteps:l,messages:h})&&await M({messages:h})},[A,O,e,j,c,p,d,L,R,N,u,o,s,n,l,S,F,y,m,_,E,v]),P=(0,i.useCallback)(async(e,{data:t,headers:r,body:a,experimental_attachments:o}={})=>{var n,s;let l=await ee(o);return M({messages:S.current.concat({...e,id:null!=(n=e.id)?n:y(),createdAt:null!=(s=e.createdAt)?s:new Date,experimental_attachments:l.length>0?l:void 0,parts:Q(e)}),headers:r,body:a,data:t})},[M,y]),V=(0,i.useCallback)(async({data:e,headers:t,body:r}={})=>{let a=S.current;return 0===a.length?null:M({messages:"assistant"===a[a.length-1].role?a.slice(0,-1):a,headers:t,body:r,data:e})},[M]),B=(0,i.useCallback)(()=>{F.current&&(F.current.abort(),F.current=null)},[]),J=(0,i.useCallback)(e=>{"function"==typeof e&&(e=e(S.current));let t=X(e);A(t,!1),S.current=t},[A]),U=(0,i.useCallback)(e=>{"function"==typeof e&&(e=e(N.current)),R(e,!1),N.current=e},[R]),[Y,$]=(0,i.useState)(a),W=(0,i.useCallback)(async(e,t={},r)=>{var a;if(null==(a=null==e?void 0:e.preventDefault)||a.call(e),!Y&&!t.allowEmptySubmit)return;r&&(j.current={...j.current,...r});let o=await ee(t.experimental_attachments);M({messages:S.current.concat({id:y(),createdAt:new Date,role:"user",content:Y,experimental_attachments:o.length>0?o:void 0,parts:[{type:"text",text:Y}]}),headers:t.headers,body:t.body,data:t.data}),$("")},[Y,y,M]);return{messages:null!=T?T:[],id:v,setMessages:J,data:k,setData:U,error:D,append:P,reload:V,stop:B,input:Y,setInput:$,handleInputChange:e=>{$(e.target.value)},handleSubmit:W,isLoading:"submitted"===x||"streaming"===x,status:x,addToolResult:(0,i.useCallback)(({toolCallId:e,result:t})=>{let r=S.current;!function({messages:e,toolCallId:t,toolResult:r}){var a;let o=e[e.length-1],n=o.parts.find(e=>"tool-invocation"===e.type&&e.toolInvocation.toolCallId===t);if(null==n)return;let s={...n.toolInvocation,state:"result",result:r};n.toolInvocation=s,o.toolInvocations=null==(a=o.toolInvocations)?void 0:a.map(e=>e.toolCallId===t?s:e)}({messages:r,toolCallId:e,toolResult:t}),A(r,!1),et(r[r.length-1])&&M({messages:r})},[A,M])}}}}]);